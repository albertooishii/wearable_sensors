{
    "version": "2.1",
    "device_type": "xiaomi_smart_band_9",
    "display_name": "Xiaomi Smart Band 9 (FE95 Protocol V1)",
    "service_filter": [
        "0000FE95-0000-1000-8000-00805F9B34FB"
    ],
    "services": {
        "FE95": {
            "uuid": "0000FE95-0000-1000-8000-00805F9B34FB",
            "name": "Xiaomi Encrypted Service",
            "characteristics": {
                "heart_rate_measurement": {
                    "uuid": "00002A37-0000-1000-8000-00805F9B34FB",
                    "parser": "heart_rate_measurement",
                    "data_type": "heart_rate",
                    "properties": [
                        "notify"
                    ]
                },
                "battery_level": {
                    "uuid": "00002A19-0000-1000-8000-00805F9B34FB",
                    "parser": "battery_level",
                    "data_type": "battery",
                    "properties": [
                        "read",
                        "notify"
                    ]
                },
                "command_write": {
                    "uuid": "00000051-0000-1000-8000-00805F9B34FB",
                    "properties": [
                        "write_no_response"
                    ],
                    "description": "Xiaomi SPP Protocol V1 - TX characteristic for sending commands TO Smart Band 9"
                },
                "command_read": {
                    "uuid": "00000052-0000-1000-8000-00805F9B34FB",
                    "properties": [
                        "notify"
                    ],
                    "description": "Xiaomi SPP Protocol V1 - RX characteristic for receiving responses FROM Smart Band 9"
                },
                "activity_data": {
                    "uuid": "00000053-0000-1000-8000-00805F9B34FB",
                    "parser": "xiaomi_activity_data",
                    "data_type": "movement",
                    "properties": [
                        "notify"
                    ],
                    "description": "Activity data stream - includes steps, movement intensity"
                }
            }
        }
    },
    "data_parsers": {
        "xiaomi_heart_rate": {
            "type": "heart_rate",
            "class": "GenericHeartRateParser",
            "description": "Standard BLE Heart Rate Measurement (0x2A37) - REUSES generic parser"
        },
        "xiaomi_battery_level": {
            "type": "battery",
            "class": "GenericBatteryLevelParser",
            "description": "Standard BLE Battery Level (0x2A19) - REUSES generic parser"
        },
        "xiaomi_activity_data": {
            "type": "movement",
            "class": "XiaomiActivityDataParser",
            "description": "Xiaomi activity stream - steps, intensity, ENMO"
        }
    },
    "authentication": {
        "protocol": "xiaomi_spp",
        "connection_type": "spp_over_ble",
        "service_uuid": "0000FE95-0000-1000-8000-00805F9B34FB",
        "command_read_uuid": "00000052-0000-1000-8000-00805F9B34FB",
        "command_write_uuid": "00000051-0000-1000-8000-00805F9B34FB",
        "encryption_required": true,
        "spp_protocol": {
            "version": "v1",
            "version_detection": {
                "enabled": false,
                "note": "Band 9 confirmed to use V1 only"
            },
            "v1_note": "All SPP V1 protocol values are UNIVERSAL across Xiaomi devices (hardcoded in code). See lib/shared/services/bluetooth/xiaomi/protocol/v1/constants.dart"
        },
        "auth_flow": {
            "step_1": "Send CMD_NONCE (type=1, subtype=26) with phoneNonce as SPP packet",
            "step_2": "Receive watchNonce + HMAC verification as SPP packet",
            "step_3": "Send CMD_AUTH (type=1, subtype=27) with encrypted device info as SPP packet",
            "step_4": "Receive confirmation (status=1 for success)"
        },
        "notes": "Smart Band 9 uses SPP Protocol V1 (confirmed) over BLE with separate write (0051) and notify (0052) characteristics. Based on Gadgetbridge XiaomiSppProtocolV1.java"
    }
}